generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model LensAccount {
  id                    String             @id
  createdAt             DateTime           @default(now())
  updatedAt             DateTime           @updatedAt
  sentConversations     ChatConversation[] @relation("ConversationSender")
  receivedConversations ChatConversation[] @relation("ConversationReceiver")
  messages              Message[]          @relation("AccountMessages")
}

model ChatConversation {
  id         String      @id @default(cuid())
  key        String      @unique
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
  sender     LensAccount @relation("ConversationSender", fields: [senderId], references: [id])
  senderId   String
  receiver   LensAccount @relation("ConversationReceiver", fields: [receiverId], references: [id])
  receiverId String
  messages   Message[]
}

model Message {
  id             String           @id @default(cuid())
  conversation   ChatConversation @relation(fields: [conversationId], references: [id])
  conversationId String
  sender         LensAccount      @relation("AccountMessages", fields: [senderId], references: [id])
  senderId       String
  content        String
  createdAt      DateTime         @default(now())
}
